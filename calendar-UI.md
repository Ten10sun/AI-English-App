# カレンダー「今日の曜日ズレ」問題まとめ

## 1. 何が原因だったのか？

- カレンダーの「日付配列（dates）」と「データ配列（daysData）」の並びが、曜日ラベルや描画ロジックと完全に一致していなかったことが主な原因。
- 具体的には…
  - 「今週の列が7日分（日〜土）」になっていなかった
  - 先頭や末尾にnullや0を追加する位置・個数が不適切だった
  - そのため、「今日」が本来の曜日（金曜）に来ず、ズレて表示されていた

---

## 2. どんな方法がダメだったのか？

- 先頭や末尾にtodayDay個nullや0を追加するだけの方法
  - → これだと「今週の列が7日分」にならない場合があり、曜日と日付の対応が崩れる
- daysDataとdatesの生成ロジックがバラバラだった
  - → 片方だけ調整しても、もう片方とズレてしまう

---

## 3. どうやって成功したのか？

### 成功した方法のポイント

1. dates配列を「今週の列が必ず7日分（日〜土）」になるように調整
   - 先頭に(todayDay+1)個nullを追加
   - 必要なら末尾にもnullを追加して、全体の長さを「週数×7」に揃える
2. daysDataもdatesと完全に同期して生成
   - dates[i]がnullならdaysData[i]もnull
   - dates[i]が日付なら、その日付のデータをdaysData[i]に入れる
3. ContributionCalendar.jsxでは、受け取ったdatesを週ごとに分割して描画
   - daysDataの同じインデックスを使って色を決定

### これにより…
- 右端の列が「今週」
- 右端のtodayDay（金曜なら下から2番目）が今日
- 曜日ラベル・履歴データ・色の位置がすべて正しく揃う

---

## まとめ

- 原因：日付配列とデータ配列の並び・長さ・null追加位置がズレていた
- ダメだった方法：片方だけ調整、または先頭/末尾のnull追加数が不適切
- 成功した方法：datesとdaysDataを完全同期し、「今週の列が7日分」になるように調整

---

さらに詳しいコード解説や、他の部分の仕組みも知りたい場合はご質問ください。 
